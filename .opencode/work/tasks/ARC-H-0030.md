# Task ARC-H-0030: Design tool-agnostic architecture for site-nine multi-tool support

**Status:** UNDERWAY
**Priority:** HIGH
**Role:** Architect
**Category:** architecture
**Agent:** 34
**Claimed:** 2026-02-03 21:17:10
**Actual Time:** 
**Closed:** 
**Paused:** 


## Objective

Based on research completed in ADM-H-0029, design the detailed architecture for making site-nine compatible with multiple AI coding tools (OpenCode, Cursor, Aider, etc.).

## Research Summary (from ADM-H-0029)
- 80% of site-nine codebase is already tool-agnostic
- Main coupling is in integration layer: skills, commands, config files
- Estimated 4-6 weeks effort for full multi-tool support
- Recommended adapter pattern approach

## Architect Deliverables

### 1. Technical Design Document
- Detailed adapter interface specifications with method signatures
- Class diagrams showing abstraction layer components
- Sequence diagrams for skill execution and command dispatch
- Data flow diagrams between site-nine core and tool adapters
- Component interaction patterns

### 2. Configuration System Design
- Formal specification for ToolConfig dataclass
- Path resolution strategy (how to map .opencode/ to .cursor/, .aider/, etc.)
- Tool detection and auto-configuration mechanism
- Environment variable and config file hierarchy
- Backward compatibility strategy for existing OpenCode users

### 3. Adapter Pattern Specification
- ToolAdapter protocol definition with all required methods
- Contract specifications (preconditions, postconditions, invariants)
- Error handling patterns
- Extension points for community adapters
- Versioning strategy

### 4. Skills System Refactoring Design
- Separate skill logic (what to do) from presentation (how to format)
- Generic skill execution engine design
- Tool-specific skill renderer architecture
- Migration path for existing OpenCode skills

### 5. Proof of Concept Specification
- Detailed scope for Cursor MCP adapter implementation
- Success criteria and acceptance tests
- Integration points with Cursor's skill system
- Demo scenario walkthrough

### 6. Architecture Decision Records (ADRs)
- ADR-001: Why adapter pattern vs other abstraction approaches
- ADR-002: Why Cursor MCP as first target vs Aider
- ADR-003: Configuration system design choices
- ADR-004: Skills refactoring approach
- ADR-005: Backward compatibility strategy

### 7. Implementation Roadmap
- Detailed Phase 1 implementation plan with task breakdown
- Dependencies between components
- Risk mitigation strategies
- Testing strategy for each phase
- Rollback procedures

### 8. Migration Guide Draft
- Step-by-step refactoring sequence
- Breaking changes assessment
- Communication plan for users
- Documentation updates needed

## Reference Material
- Task ADM-H-0029: Research findings and analysis
- Current codebase: src/site_nine/ (especially core, agents, tasks)
- .opencode/ directory structure and conventions
- Cursor MCP documentation
- Aider architecture

## Success Criteria
- Architect review-ready design documents
- All key decisions documented in ADRs
- Builder can start Phase 1 implementation without architectural blockers
- Clear acceptance criteria for each deliverable

## Problem Statement

[Describe the problem or need - explain current state, why it's problematic, impact]

## Implementation Steps

[Chronological log of work done - update as you go, document decisions]

## Files Changed

### Created
- [file path] - [description]

### Modified
- [file path] - [description]

## Testing Performed

[Document test commands, results, verification]

## Notes

[Progress notes, questions, blockers]