# Task OPR-H-0063: Implement database-backed architecture document (ADR) tracking and linking system

**Status:** UNDERWAY
**Priority:** HIGH
**Role:** Operator
**Category:** 
**Mission:** 
**Claimed:** 2026-02-04 17:39:44
**Actual Time:** 
**Closed:** 
**Paused:** 
**Related Architecture:**
- [ADR-006](.opencode/docs/adrs/ADR-006-entity-model-clarity.md): Entity Model Clarity - Personas, Missions, and Agents (ACCEPTED)


## Objective

Implement a database-backed system for tracking Architecture Decision Records (ADRs) and linking them to epics and tasks. The database should be the source of truth, with markdown files reflecting the database state through sync operations.

Requirements:
1. Database Schema:
   - Create 'architecture_docs' table to track ADRs (id, title, status, file_path, created_at, updated_at)
   - Create 'epic_architecture_docs' linking table (epic_id, adr_id)
   - Create 'task_architecture_docs' linking table (task_id, adr_id)
   - ADR status values: PROPOSED, ACCEPTED, REJECTED, SUPERSEDED, DEPRECATED

2. CLI Commands:
   - 's9 adr create' - Create new ADR with database entry
   - 's9 adr list' - List all ADRs with status
   - 's9 adr show <id>' - Show ADR details and linked epics/tasks
   - 's9 adr update' - Update ADR status/metadata
   - 's9 epic link-adr <epic-id> <adr-id>' - Link ADR to epic
   - 's9 epic unlink-adr <epic-id> <adr-id>' - Unlink ADR from epic
   - 's9 task link-adr <task-id> <adr-id>' - Link ADR to task
   - 's9 task unlink-adr <task-id> <adr-id>' - Unlink ADR from task
   - 's9 adr sync' - Sync markdown files with database (update 'Related Architecture' sections)

3. Epic Markdown Integration:
   - Epic sync should update 'Related Architecture' section from database
   - Section should show linked ADRs with title, path, and status
   - Keep format consistent with current manual approach

4. Task Markdown Integration:
   - Task sync should update related ADRs section if ADRs linked
   - Format similar to epic approach

5. Database Migration:
   - Create Alembic migration for new tables
   - Scan existing .opencode/docs/adrs/ directory and import ADRs
   - Parse existing epic markdown files for ADR references to pre-populate links

6. Documentation:
   - Update docs/guides/ with ADR workflow
   - Document CLI commands
   - Add examples of linking ADRs to epics/tasks

Acceptance Criteria:
- All database tables created with proper constraints
- All CLI commands working and tested
- Epic/task markdown sync includes ADR information from database
- Existing ADRs imported into database
- Documentation complete

Reference: ADM-H-0051 discussion on epic/ADR linking needs

## Problem Statement

[Describe the problem or need - explain current state, why it's problematic, impact]

## Implementation Steps

[Chronological log of work done - update as you go, document decisions]

## Files Changed

### Created
- [file path] - [description]

### Modified
- [file path] - [description]

## Testing Performed

[Document test commands, results, verification]

## Notes

[Progress notes, questions, blockers]