# Task TST-H-0052: Verify UUID-based session detection works in production

**Status:** ABORTED
**Priority:** HIGH
**Role:** Tester
**Category:** testing
**Mission:** 
**Claimed:** 
**Actual Time:** 
**Closed:** 2026-02-04 07:13:21
**Paused:** 
## Objective

Test the UUID-based session detection feature to ensure it correctly identifies OpenCode sessions when multiple sessions are active.

## What Was Implemented

1. generate-session-uuid command generates unique UUIDs like 'session-marker-abc123'
2. UUIDs are captured in OpenCode's part files (message tool outputs)
3. rename-tui --uuid-marker searches part files to find the session that generated that UUID
4. This solves the 'wrong session renamed' problem when multiple OpenCode sessions are active

## Files Changed

- src/site_nine/cli/mission.py:
  - _detect_session_via_uuid_marker() - searches part files for UUID
  - _find_opencode_storage() - returns part_storage path
  - rename_tui() - passes part_storage to detection function
  - generate_session_uuid() - generates UUIDs

- .opencode/skills/session-start/SKILL.md:
  - Updated with UUID generation step
  - Documents recommended workflow

## Testing Procedure

1. Open 2+ OpenCode sessions in the same project
2. In Session A: Run 's9 mission generate-session-uuid', capture UUID
3. In Session B: Run 's9 mission generate-session-uuid', capture different UUID
4. In Session A: Run 's9 mission rename-tui NameA RoleA --uuid-marker UUID_FROM_A'
5. Verify Session A was renamed (not Session B)
6. In Session B: Run 's9 mission rename-tui NameB RoleB --uuid-marker UUID_FROM_B'
7. Verify Session B was renamed (not Session A)

## Expected Results

- Each rename-tui should correctly identify the session that generated its UUID
- No 'wrong session renamed' errors
- Debug logs should show 'session_detected_via_uuid_marker'
- Fallback detection methods should not be needed when UUID is provided

## Edge Cases to Test

- UUID not found (old/expired): Should fall back gracefully with warning
- Very recent session (< 1 second old): Should still find the UUID
- Session in different project: Should not match even with same UUID

## Success Criteria

✓ UUID detection works reliably with 2+ concurrent sessions
✓ Each session renames the correct session
✓ Fallback works when UUID not found
✓ No race conditions or timing issues

## Problem Statement

[Describe the problem or need - explain current state, why it's problematic, impact]

## Implementation Steps

[Chronological log of work done - update as you go, document decisions]

## Files Changed

### Created
- [file path] - [description]

### Modified
- [file path] - [description]

## Testing Performed

[Document test commands, results, verification]

## Notes

Task completed as part of OPR-H-0054 and verified during mission storm-apex session start. UUID workflow tested successfully: generated UUID marker, renamed correct session with --uuid-marker flag, verified in production use. See handoff completion report in .opencode/work/missions/handoffs/2026-02-03.22:42:49.operator-oceanus.operator.completed.md for comprehensive test results.